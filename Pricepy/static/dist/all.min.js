var app=angular.module("myApp",["ngRoute","ngSanitize","ngCookies","ngAnimate","ngTouch","ngYoutubeEmbed"]);app.config(["$routeProvider","$locationProvider",function(e,t){var n="static/src/app/templates/";e.when("/",{templateUrl:n+"home.htm",controller:"homeController"}).when("/news",{templateUrl:n+"news.htm",controller:"newsController"}).when("/usefulText",{templateUrl:n+"usefulText.htm",controller:"usefulTextController"}).when("/usefulVideo",{templateUrl:n+"usefulVideo.htm",controller:"usefulVideoController"}).when("/machines/:machineId",{templateUrl:n+"machinePage.htm",controller:"machineController",machineId:"machineId"}).when("/machines",{templateUrl:n+"machines.htm",controller:"machinesController"}).when("/arenda",{templateUrl:n+"arenda.htm",controller:"arendaController"}).when("/contact",{templateUrl:n+"contact.htm",controller:"contactController"}).when("/notFound",{templateUrl:n+"notFound.htm",controller:"notFoundController"}).otherwise("/notFound",{templateUrl:n+"notFound.htm",controller:"notFoundController"}),t.html5Mode(!0)}]),app.controller("appController",["$scope","$location","$http","getData","dateService",function(e,t,n,a,i){e.path=t.path(),a.getContent("/api/Values","header").then(function(t){e.data={},e.data.header=t,void 0,a.getContent("/api/Values","footer").then(function(t){e.data.footer=t,void 0}),null!=e.machines&&a.getContent("/api/Values","machines").then(function(t){void 0,e.machines=t,void 0,void 0})})}]),app.controller("arendaController",["$scope","$location","getData",function(e,t,n){e.$parent.path="/arenda",n.getContent("/api/Values","arenda").then(function(t){e.data=t,e.$parent.pageTitle=t.pageTitle,e.$parent.pageDescription=t.pageDescription})}]),app.controller("calendarController",["$scope","calendarService",function(e,t){void 0,e.bookedDates=e.$parent.machine.bookedDates,e.bookedDates&&(e.bookedDates=e.bookedDates.split(",")),void 0;var n=function(n){var a=n;void 0;var i=a.toDateString(),o=t.getFirstDayOfMonth(i),r=t.getLastDayOfMonth(i);e.arr=t.getMonthArray(o,r)},a=function(t,n){for(var a=new Date(t),i=a.getDate(),o=0;o<e.arr.length;o++)for(var r=0;r<e.arr[o].length;r++)if(e.arr[o][r].value==i){e.arr[o][r][n]=!0;break}void 0},i=function(){for(var n=0;n<e.bookedDates.length;n++){var i=new Date(e.bookedDates[n]);i.getMonth()==r.getMonth()&&i.getFullYear()==r.getFullYear()&&(t.isDatePast(o.toDateString(),e.bookedDates[n])||a(e.bookedDates[n],"booked"))}},o=new Date,r=new Date;e.monthTitle=t.getMonthAndYearStr(r.toDateString()),n(r),a(o.toDateString(),"today"),i(),e.nextMonth=function(){r=t.increaseMonth(r),e.monthTitle=t.getMonthAndYearStr(r.toDateString()),n(r),o.getMonth()==r.getMonth()&&o.getFullYear()==r.getFullYear()&&a(o.toDateString(),"today"),i()},e.prevMonth=function(){r=t.decreaseMonth(r),e.monthTitle=t.getMonthAndYearStr(r.toDateString()),n(r),o.getMonth()==r.getMonth()&&o.getFullYear()==r.getFullYear()&&a(o.toDateString(),"today"),i()}}]),app.controller("contactController",["$scope","$http","getData",function(e,t,n){e.$parent.path="/contact",n.getContent("/api/Values","contacts").then(function(n){e.data=n,e.banner=n.banner,e.$parent.pageTitle=n.pageTitle,e.$parent.pageDescription=n.pageDescription,e.isSucceeded=!1,e.isError=!1,e.submit=function(){e.messagesForm.$invalid||t({method:"POST",url:"/api/Messages",data:e.form}).then(function(t){t.data?e.isSucceeded=!0:e.isError=!0},function(t){e.isError=!0})}})}]),app.controller("homeController",["$scope","$location","getData","dateService",function(e,t,n,a){void 0,e.$parent.path="/",e.showSlides=!1,n.getContent("/api/Values","home").then(function(t){e.data=t,e.$parent.pageTitle=t.pageTitle,e.$parent.pageDescription=t.pageDescription,e.showSlides=!0,e.newsTitleItem=e.data.sections.filter(function(e){return"Новости"==e.type})[0],e.newsTitleItem.months=a.getNiceDate(e.newsTitleItem.date).months,e.newsTitleItem.day=a.getNiceDate(e.newsTitleItem.date).day,e.newsTitleItem.year=a.getNiceDate(e.newsTitleItem.date).year,e.textItem=e.data.sections.filter(function(e){return"Полезная информация"==e.type&&-1==e.tags.indexOf("Видео")})[0],e.textItem.textHtml=e.textItem.textHtml.match("<p>(.*?)</p>")[0],e.textItem.months=a.getNiceDate(e.textItem.date).months,e.textItem.day=a.getNiceDate(e.textItem.date).day,e.textItem.year=a.getNiceDate(e.textItem.date).year,e.videoItem=e.data.sections.filter(function(e){return"Полезная информация"==e.type&&-1!=e.tags.indexOf("Видео")})[0],e.videoItem.textHtml=e.videoItem.textHtml.match("<p>(.*?)</p>")[0],e.videoItem.months=a.getNiceDate(e.videoItem.date).months,e.videoItem.day=a.getNiceDate(e.videoItem.date).day,e.videoItem.year=a.getNiceDate(e.videoItem.date).year})}]),app.controller("machineController",["$scope","$routeParams","$location","getData","filterService","cookiesService",function(e,t,n,a,i,o){void 0,e.$parent.path="/machines",e.machineName=t.machineId,e.categories=o.getObject("categories",{CategoryB:!0,CategoryE:!0}),e.availibilityFilterValue=o.getObject("availibilityFilterValue",{useFilter:!1}),a.getContent("/api/Values","machine").then(function(t){e.data=t,e.banner=e.data.banner,void 0;var i=t.pageTitle;if(e.$parent.machines){var t=e.$parent.machines;e.machines=t,e.machine={};var o=!1;e.machines.gallery.items.map(function(t){t.isVisible=!0,t.name==e.machineName&&(e.machine=t,e.index=t.id,o=!0)}),o||n.url(e.machines.gallery.items[0].href),e.machine.priceLabel=t.gallery.priceLabel,e.machines.gallery.items[e.index-1].isVisible=!1,e.isShowSecondaryImages=e.machine.secondaryImages.length>1,e.$parent.pageTitle=e.machine.description+" "+i,e.$parent.pageDescription=e.machine.description+" "+t.gallery.priceLabel+" "+e.machine.price,e.activeImg=e.machine.secondaryImages[0],e.contentLoaded=!0}else a.getContent("/api/Values","machines").then(function(t){e.$parent.machines=t,e.machines=t,e.machine={};var a=!1;e.machines.gallery.items.map(function(t){t.name==e.machineName&&(e.machine=t,e.index=t.id,a=!0)}),a||n.url(e.machines.gallery.items[0].href),e.machine.priceLabel=t.gallery.priceLabel,e.machines.gallery.items[e.index-1].isVisible=!1,e.isShowSecondaryImages=e.machine.secondaryImages.length>1,e.$parent.pageTitle=e.machine.description+" "+i,e.$parent.pageDescription=e.machine.description+" "+t.gallery.priceLabel+" "+e.machine.price,e.activeImg=e.machine.secondaryImages[0],e.contentLoaded=!0})}),e.setActive=function(t){e.activeImg=t},e.setPreviousImageActive=function(){for(var t=0;t<e.machine.secondaryImages.length;t++){if(e.machine.secondaryImages[t].img.imgSrc==e.activeImg.img.imgSrc&&0!=t){e.setActive(e.machine.secondaryImages[t-1]);break}}},e.setNextImageActive=function(){for(var t=0;t<e.machine.secondaryImages.length;t++){if(e.machine.secondaryImages[t].img.imgSrc==e.activeImg.img.imgSrc&&t!=e.machine.secondaryImages.length-1){void 0,e.setActive(e.machine.secondaryImages[t+1]);break}}},e.gotoPage=function(e){n.url(e)},e.saveCategoryFilter=function(){o.saveObject("categories",e.categories)},e.saveAvailibilityFilterValue=function(){o.saveObject("availibilityFilterValue",e.availibilityFilterValue)},e.categoryFilter=i.categoryFilter,e.availibilityFilter=i.availibilityFilter}]),app.controller("machinesController",["$scope","getData","dateService","filterService","cookiesService",function(e,t,n,a,i){if(e.$parent.path="/machines",e.categories=i.getObject("categories",{CategoryB:!0,CategoryE:!0}),e.availibilityFilterValue=i.getObject("availibilityFilterValue",{useFilter:!1}),e.$parent.machines){var o=e.$parent.machines;e.data=o,e.data.gallery.items.map(function(t){t.isVisible=!0,0==t.availibility&&t.availibilityDate&&n.isExpired(t.availibilityDate)&&(t.availibility=!0,t.availibilityLabel=e.data.gallery.availibilityTrueLabel)}),e.$parent.pageTitle=o.pageTitle,e.$parent.pageDescription=o.pageDescription}else t.getContent("/api/Values","machines").then(function(t){e.$parent.machines=t,e.data=t,e.data.gallery.items.map(function(t){0==t.availibility&&t.availibilityDate&&n.isExpired(t.availibilityDate)&&(t.availibility=!0,t.availibilityLabel=e.data.gallery.availibilityTrueLabel)}),e.$parent.pageTitle=t.pageTitle,e.$parent.pageDescription=t.pageDescription});e.saveCategoryFilter=function(){i.saveObject("categories",e.categories)},e.saveAvailibilityFilterValue=function(){i.saveObject("availibilityFilterValue",e.availibilityFilterValue)},e.categoryFilter=a.categoryFilter,e.availibilityFilter=a.availibilityFilter}]),app.controller("newsController",["$scope","$location","getData","dateService",function(e,t,n,a){e.$parent.path="/news",n.getContent("/api/Values","home").then(function(t){e.data=t,e.$parent.pageTitle=t.pageTitle,e.$parent.pageDescription=t.pageDescription,e.newsTitleItems=e.data.sections.filter(function(e){return"Новости"==e.type}),e.newsTitleItems.forEach(function(e){e.months=a.getNiceDate(e.date).months,e.day=a.getNiceDate(e.date).day,e.year=a.getNiceDate(e.date).year,e.fullDate=a.getNiceDate(e.date).fullDate})})}]),app.controller("notFoundController",["$scope","getData",function(e,t){t.getContent("/api/Values","notFound").then(function(t){e.data=t,e.$parent.pageTitle=t.pageTitle,e.$parent.pageDescription=t.pageDescription})}]),app.controller("scrollToAnchorController",["$scope","anchorSmoothScroll",function(e,t){e.gotoElement=function(e){t.scrollTo(e)}}]),app.controller("sliderController",["$scope","$location","$interval","getData","dateService",function(e,t,n,a,i){void 0,e.banners=e.$parent.data.banners,e.activeIndex=0;var o,r=function(t){for(var n=0;n<e.banners.length;n++)e.banners[n].isActive=t==n};e.banners&&(1==e.banners.length&&r(0),e.banners.length>1&&function(){r(e.activeIndex),o=n(function(){void 0,e.activeIndex++,e.activeIndex>=e.banners.length&&(e.activeIndex=0),r(e.activeIndex)},8e3)}()),e.$on("$destroy",function(){n.cancel(o)})}]),app.controller("timerController",["$scope","$interval","dateService",function(e,t,n){void 0;e.daysLeft="",e.hoursLeft="",e.minutesLeft="",e.secondsLeft="",e.isLoaded=!1;var a=e.$parent.banner.finishDateTime,i=t(function(){void 0;var n=o(a);e.hoursLeft=n.hours,e.minutesLeft=n.minutes,e.secondsLeft=n.seconds,e.daysLeft=n.days,e.isLoaded=!0,n.total<=0&&t.cancel(i)},1e3),o=function(e){var t=Date.parse(e)-Date.parse(new Date),n=Math.floor(t/1e3%60),a=Math.floor(t/1e3/60%60),i=Math.floor(t/36e5%24);return{total:t,days:Math.floor(t/864e5),hours:i,minutes:a,seconds:n}};e.isActionFinished=!n.isExpired(a),e.$on("$destroy",function(){t.cancel(i)})}]),app.controller("toggleMenuController",["$scope","$rootScope","$window",function(e,t,n){e.isMobile=n.innerWidth<768,e.isOpen=!e.isMobile,e.toggleMenu=function(){e.isOpen=!e.isOpen},t.$on("$routeChangeStart",function(t,a,i){e.isMobile=n.innerWidth<768,e.isOpen=!e.isMobile})}]),app.controller("usefulTextController",["$scope","$location","getData","dateService",function(e,t,n,a){e.$parent.path="/usefulText",n.getContent("/api/Values","home").then(function(t){e.data=t,e.$parent.pageTitle=t.pageTitle,e.$parent.pageDescription=t.pageDescription,e.textItems=e.data.sections.filter(function(e){return"Полезная информация"==e.type&&-1==e.tags.indexOf("Видео")}),e.textItems.forEach(function(e){e.fullDate=a.getNiceDate(e.date).fullDate}),e.activeSection=e.textItems[0],e.viewSection=function(t){e.activeSection=t}})}]),app.controller("usefulVideoController",["$scope","$location","getData","dateService",function(e,t,n,a){e.$parent.path="/usefulVideo",n.getContent("/api/Values","home").then(function(t){e.data=t,e.$parent.pageTitle=t.pageTitle,e.$parent.pageDescription=t.pageDescription,e.videoItems=e.data.sections.filter(function(e){return"Полезная информация"==e.type&&-1!=e.tags.indexOf("Видео")}),e.videoItems.forEach(function(e){e.fullDate=a.getNiceDate(e.date).fullDate}),e.activeSection=e.videoItems[0],e.viewSection=function(t){e.activeSection=t}})}]),app.directive("matchHeight",["$timeout","$window",function(e,t){return{restrict:"A",link:function(n,a,i){n.matchHeight=function(){e(function(){var e=a[0].getElementsByClassName("item-img");if("toLarger"==i.matchHeight)for(var t=1,n=0;n<e.length;n++){e[n].style.height="auto";var o=e[n].height;if(void 0==o&&(o=e[n].clientHeight),0==o){var r=angular.element(e[n]);r.hasClass("ng-hide")?(r.removeClass("ng-hide"),o=e[n].clientHeight,r.addClass("ng-hide")):o=200}o>t&&(t=o)}else for(var t=1e3,n=0;n<e.length;n++){e[n].style.height="auto";var o=e[n].height;if(void 0==o&&(o=e[n].clientHeight),0==o){var r=angular.element(e[n]);r.hasClass("ng-hide")?(r.removeClass("ng-hide"),o=e[n].clientHeight,r.addClass("ng-hide")):o=200}o<t&&(t=o)}for(var n=0;n<e.length;n++)e[n].style.height=t+"px"},900)},n.matchHeight(),angular.element(t).bind("resize",function(){n.matchHeight()})}}}]),app.directive("setMap",["$timeout",function(e){return{restrict:"A",link:function(t,n,a){function i(){var e={lat:53.841885,lng:27.524684},t=new google.maps.Map(n[0],{zoom:15,center:e});new google.maps.Marker({position:e,map:t})}e(function(){i()},500)}}}]),app.directive("showWhen",["$window",function(e){return{restrict:"A",link:function(t,n,a){t.checkExpose=function(){var t="large"==a.showWhen?"(min-width:768px)":a.showWhen;e.matchMedia(t).matches?n.removeClass("ng-hide"):(void 0,n.addClass("ng-hide"))},t.checkExpose(),angular.element(e).bind("resize",function(){t.checkExpose()})}}}]),app.filter("addLeadingZero",function(){return function(e){return e<10?"0"+e:e}}),app.service("anchorSmoothScroll",function(){this.scrollTo=function(e){var t=function(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}(),n=function(e){for(var t=document.getElementById(e),n=t.offsetTop,a=t;a.offsetParent&&a.offsetParent!=document.body;)a=a.offsetParent,n+=a.offsetTop;return n}(e),a=n>t?n-t:t-n;if(a<100)return void scrollTo(0,n);var i=Math.round(a/100);i>=20&&(i=20);var o=Math.round(a/25),r=n>t?t+o:t-o,l=0;if(n>t)for(var c=t;c<n;c+=o)setTimeout("window.scrollTo(0, "+r+")",l*i),r+=o,r>n&&(r=n),l++;else for(var c=t;c>n;c-=o)setTimeout("window.scrollTo(0, "+r+")",l*i),r-=o,r<n&&(r=n),l++}}),app.service("calendarService",function(){var e={month:"long",year:"numeric"};return{getFirstDayOfMonth:function(e){var t=new Date(e);return t.setDate(1),0==t.getDay()?7:t.getDay()},getLastDayOfMonth:function(e){var t=new Date(e);return new Date(t.getFullYear(),t.getMonth()+1,0).getDate()},isDatePast:function(e,t){var n=new Date(e);return n.setHours(0,0,0,0),new Date(t)<n},getMonthAndYearStr:function(t){return new Date(t).toLocaleDateString("ru-ru",e)},increaseMonth:function(e){return 11==e.getMonth()?(e.setFullYear(e.getFullYear()+1),e.setMonth(0)):e.setMonth(e.getMonth()+1),e},decreaseMonth:function(e){return 0==e.getMonth()?(e.setFullYear(e.getFullYear()-1),e.setMonth(11)):e.setMonth(e.getMonth()-1),e},getMonthArray:function(e,t){for(var n=1,a=!1,i=[],o=0;o<=5;o++)if(!a&&n<=t){i.push([]);for(var r=0;r<=6;r++)0==o&&r+1<e?i[o][r]={value:""}:n>t?(i[o][r]={value:""},a=!0):(i[o][r]={value:n},n++)}return i}}}),app.service("cookiesService",["$cookies",function(e){return{saveObject:function(t,n){var a=new Date;a.setHours(a.getHours()+1),e.put(t,JSON.stringify(n),{expires:a})},getObject:function(t,n){var a=e.get(t);return a?JSON.parse(a):n}}}]),app.service("dateService",function(){return{isExpired:function(e){if(e){return new Date>new Date(e)}return null},getNiceDate:function(e){var t=new Date(e);return{months:t.toLocaleString("ru-be",{month:"long"}),day:t.getDate(),year:t.getFullYear(),fullDate:t.toLocaleDateString("ru-be",{month:"long",year:"numeric",day:"numeric"})}}}}),app.service("filterService",["textConstantService",function(e){return{categoryFilter:function(t){return function(n){if((t.CategoryB||!n.fullInfo.category.includes(e.categories.categoryB))&&(t.CategoryE||!n.fullInfo.category.includes(e.categories.categoryE)))return n}},availibilityFilter:function(e){return function(t){return e?t.availibility?t:void 0:t}}}}]),app.service("getData",["$http",function(e){return{getContent:function(t,n){return e({method:"Get",url:t,params:{sectionName:n}}).then(function(e){return e.data},function(e){void 0})}}}]),app.value("textConstantService",{categories:{categoryB:"Категория B",categoryE:"Категория E"},available:{trueValue:"true"}});