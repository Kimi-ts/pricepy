var adminApp=angular.module("adminApp",["ngRoute","ngSanitize","ngCookies"]);adminApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"static/admin/templates/signin.htm",controller:"signinController"}).when("/gallery",{templateUrl:"static/admin/templates/gallery.htm",controller:"galleryController"})}]),adminApp.controller("adminController",["$scope","$location","$http","getData",function(e,o,n,l){e.path=o.path(),console.log("hello from Admin"),l.getContent("/api/Values","header").then(function(o){e.data={},e.data.header=o,console.log(e.data),l.getContent("/api/Values","footer").then(function(o){e.data.footer=o,console.log(e.data)})})}]),adminApp.controller("galleryController",["$scope","$location","$http","getData","myVars",function(e,o,n,l,t){console.log("gallery controller runs"),e.$parent.path="/gallery",e.isDataUpdated=!1,l.getContent("/api/AdminValues","adminGallery").then(function(n){console.log("in gallery controller"),console.log(n),e.data=n,l.getContent("/api/AdminValues","machines").then(function(n){console.log(n),null==n?o.path("/"):e.machines=n})}),e.clearAvailibilityTextBox=function(e){e.availibilityLabel=""},e.editFullInfo=function(o){e.activeItem=o},e.save=function(){if(console.log("save called"),!e.galleryForm.$invalid&&!e.galleryForm.$pristine||!e.fullInfoForm.$invalid&&!e.fullInfoForm.$pristine){var o=t.tokenValue;console.log("im sensing data"),e.updatedMachines=[];for(var l=0;l<e.machines.gallery.items.length;l++){var a={},i=e.machines.gallery.items[l];a.Name=i.name,a.IsAvailable=i.availibility,a.AvailibilityLabel=i.availibilityLabel,a.IsDiscount=i.discount,a.Price=i.price,a.FullInfo=JSON.stringify(i.fullInfo),e.updatedMachines.push(a)}console.log("short collection:"),console.log(e.updatedMachines),n({method:"POST",url:"/api/Gallery",data:e.updatedMachines,contentType:"application/x-www-form-urlencoded",headers:{"X-Token":o}}).then(function(o){console.log("finally returned:"),console.log(o),o.data?(console.log("true"),e.isDataUpdated=!0,e.isError=!1):e.isError=!0})}}}]),adminApp.controller("signinController",["$scope","$http","$location","$cookies","getData","myVars",function(e,o,n,l,t,a){console.log("sign in controller runs"),e.$parent.path="/sign in",e.isError=!1,t.getContent("/api/Values","signin").then(function(t){e.data=t,console.log(e.data),e.submit=function(){e.messagesForm.$invalid||o({method:"POST",url:"/api/AdminValues",data:e.form}).then(function(o){console.log(o),o.data?(console.log("true"),e.isError=!1,a.tokenValue=o.data.Value,l.put("X-Token",a.tokenValue),n.path("/gallery")):e.isError=!0},function(o){e.isError=!0,console.log("error occured on our server"),console.log(o)})}})}]),adminApp.service("getData",["$http","$cookies","myVars",function(e,o,n){return{getContent:function(l,t){var a=n.tokenValue;return console.log("token value inside GETDATA service:"),console.log(a),a||(a=o.get("X-Token")),console.log("X-token"),console.log(a),e({method:"Get",url:l,params:{sectionName:t},headers:{"X-Token":a}}).then(function(e){return e.data},function(e){console.log("error")})}}}]),adminApp.value("myVars",{tokenValue:null});