var adminApp=angular.module("adminApp",["ngRoute","ngSanitize","ngCookies"]);adminApp.config(["$routeProvider",function(o){o.when("/",{templateUrl:"static/admin/templates/signin.htm",controller:"signinController"}).when("/gallery",{templateUrl:"static/admin/templates/gallery.htm",controller:"galleryController"}).when("/news",{templateUrl:"static/admin/templates/news.htm",controller:"newsController"})}]),adminApp.controller("adminController",["$scope","$location","$http","getData",function(o,e,n,t){o.path=e.path(),console.log("hello from Admin"),t.getContent("/api/Values","header").then(function(e){o.data={},o.data.header=e,console.log(o.data),t.getContent("/api/Values","footer").then(function(e){o.data.footer=e,console.log(o.data)})})}]),adminApp.controller("galleryController",["$scope","$location","$http","getData","myVars",function(o,e,n,t,l){console.log("gallery controller runs"),o.$parent.path="/gallery",o.isDataUpdated=!1,t.getContent("/api/AdminValues","adminGallery").then(function(n){console.log("in gallery controller"),console.log(n),o.data=n,t.getContent("/api/AdminValues","machines").then(function(n){console.log(n),null==n?e.path("/"):o.machines=n})}),o.clearAvailibilityTextBox=function(o){o.availibilityLabel=""},o.editFullInfo=function(e){o.isDisplayFullInfoPanel=!0,o.activeItem=e},o.save=function(){if(console.log("save called"),!o.galleryForm.$invalid&&!o.galleryForm.$pristine||!o.fullInfoForm.$invalid&&!o.fullInfoForm.$pristine){var e=l.tokenValue;console.log("im sensing data"),o.updatedMachines=[];for(var t=0;t<o.machines.gallery.items.length;t++){var a={},r=o.machines.gallery.items[t];a.Name=r.name,a.IsAvailable=r.availibility,a.AvailibilityLabel=r.availibilityLabel,a.IsDiscount=r.discount,a.Price=r.price,a.FullInfo=JSON.stringify(r.fullInfo),o.updatedMachines.push(a)}console.log("short collection:"),console.log(o.updatedMachines),n({method:"POST",url:"/api/Gallery",data:o.updatedMachines,contentType:"application/x-www-form-urlencoded",headers:{"X-Token":e}}).then(function(e){console.log("finally returned:"),console.log(e),e.data?(console.log("true"),o.isDataUpdated=!0,o.isError=!1):o.isError=!0})}}}]),adminApp.controller("newsController",["$scope","$location","$http","getData","myVars",function(o,e,n,t,l){console.log("news controller runs"),o.$parent.path="/news",o.isDataUpdated=!1,t.getContent("/api/Values","home").then(function(e){console.log(e),o.data=e}),o.postToServer=function(){if(!o.newsForm.$invalid&&!o.newsForm.$pristine){var e=l.tokenValue,t=JSON.stringify(JSON.stringify(o.data.sections));n({method:"POST",url:"/api/News",data:t,contentType:"application/x-www-form-urlencoded",headers:{"X-Token":e}}).then(function(e){e.data?(o.isDataUpdated=!0,o.isError=!1):o.isError=!0})}}}]),adminApp.controller("scrollToAnchorController",["$scope","anchorSmoothScroll",function(o,e){o.gotoElement=function(o){e.scrollTo(o)}}]),adminApp.controller("signinController",["$scope","$http","$location","$cookies","getData","myVars",function(o,e,n,t,l,a){console.log("sign in controller runs"),o.$parent.path="/sign in",o.isError=!1,l.getContent("/api/Values","signin").then(function(l){o.data=l,console.log(o.data),o.submit=function(){o.messagesForm.$invalid||e({method:"POST",url:"/api/AdminValues",data:o.form}).then(function(e){console.log(e),e.data?(console.log("true"),o.isError=!1,a.tokenValue=e.data.Value,t.put("X-Token",a.tokenValue),n.path("/gallery")):o.isError=!0},function(e){o.isError=!0,console.log("error occured on our server"),console.log(e)})}})}]),adminApp.service("anchorSmoothScroll",function(){this.scrollTo=function(o){var e=function(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}(),n=function(o){for(var e=document.getElementById(o),n=e.offsetTop,t=e;t.offsetParent&&t.offsetParent!=document.body;)t=t.offsetParent,n+=t.offsetTop;return n}(o),t=n>e?n-e:e-n;if(t<100)return void scrollTo(0,n);var l=Math.round(t/100);l>=20&&(l=20);var a=Math.round(t/25),r=n>e?e+a:e-a,i=0;if(n>e)for(var s=e;s<n;s+=a)setTimeout("window.scrollTo(0, "+r+")",i*l),r+=a,r>n&&(r=n),i++;else for(var s=e;s>n;s-=a)setTimeout("window.scrollTo(0, "+r+")",i*l),r-=a,r<n&&(r=n),i++}}),adminApp.service("getData",["$http","$cookies","myVars",function(o,e,n){return{getContent:function(t,l){var a=n.tokenValue;return console.log("token value inside GETDATA service:"),console.log(a),a||(a=e.get("X-Token")),console.log("X-token"),console.log(a),o({method:"Get",url:t,params:{sectionName:l},headers:{"X-Token":a}}).then(function(o){return o.data},function(o){console.log("error")})}}}]),adminApp.value("myVars",{tokenValue:null});